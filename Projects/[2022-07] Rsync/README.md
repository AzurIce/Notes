# Rsync

暂定毕设项目，基于 Git 思想与 CRDT 的 P2P 文件同步软件



同步的目标目录，可以视为一个数据结构。对于文件同步这个任务来说，目标就是对于某一个状态的多个复制，在各自随意修改后，可以保证最终达到一个统一的结果。



思路：

1. 设计出类似于 `.git` 的状态表示以及与实际文件目录的关系
2. 设计出一种算法/协议，可以在一个分布式网络中传递并更新这个状态
3. 实现出一个能够支撑上述内容的网络。



Git 作为一个 **版本管理** 工具，是完全可以完成 **文件同步** 的任务的。假如我在每一台机器上自动的进行 `add`、`commit`、`push`、`pull`，也就完成了这个任务（当然，冲突需要手动解决，很合理），然而带来的问题就是，`.git` 中会保存极其臃肿的版本信息（因为每一个历史版本都会被创建一个快照永久保存下来）。

不过实际的 **文件同步** 对 **版本管理** 的要求并没有那么高，也就是说我们并不要求每一个修改版本都被保存下来。但是这就存在着一个问题，**Git** 之所以有能力完成同步的任务，是因为它所保存的这个快照数据库以及所维护的快照之间的关系实际上构成了一个 CvCRDT（类似于 G-Set），换句话说它能实现同步正是因为它保存了每一个快照，且维护了它们之间的联系。

所以应当设计一个高效的 CRDT 结构，依据这个结构能够得到一切实现 **文件同步** 所需的信息。这里并没有说，将文件目录映射为一个 CRDT，因为这是不可能的，当一个文件同时在两个地方被更改（这里的同时表示的并不是时间意义上的同时，而是状态意义上的同时），这个冲突必然需要人为手动来解决。然而 CRDT 中要同时将这两个变更信息都记录下来，且不影响其他部分，如此才能够在后续手动解决。

